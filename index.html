<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Scene Gallery</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- ローディングオーバーレイ -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="spinner"></div>
        <p class="loading-message" id="loading-message">処理中...</p>
    </div>

    <header>
        <div class="header-top">
            <a href="#" class="logo">
                <span class="logo-title">SCENE <span class="logo-gallery">GALLERY</span></span>
                <span class="logo-subtitle">みんなのリファレンス</span>
            </a>
            <nav>
                <button class="bookmark-nav-btn" onclick="openBookmarksModal()" id="bookmark-link">
                    <svg viewBox="0 0 24 24"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/></svg>
                    <span>Bookmarks</span>
                    <span class="bookmark-count" id="bookmark-count">0</span>
                </button>
                <button class="trash-btn" onclick="openTrashModal()">
                    <svg viewBox="0 0 24 24">
                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                    <span class="trash-badge" id="trash-badge"></span>
                </button>
                <button class="select-mode-btn" id="select-mode-btn" onclick="toggleSelectMode()">
                    <svg viewBox="0 0 24 24">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    <span>選択</span>
                </button>
                <button class="nav-btn" onclick="loadVideos(true)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                    </svg>
                    <span>更新</span>
                </button>
                <button class="nav-btn primary" onclick="showUploadModal()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                    <span>新規アップロード</span>
                </button>
            </nav>
        </div>
        <div class="header-bottom">
            <div class="status-bar-mini">
                <div class="status-indicator-mini" id="status-indicator"></div>
                <span class="status-text-mini" id="status-text">接続確認中...</span>
            </div>
            <div class="search-bar">
                <svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                <input type="text" id="search-input" placeholder="タイトル、特徴で検索..." oninput="searchVideos()">
                <button class="search-clear" id="search-clear" onclick="clearSearch()" style="display:none;">✕</button>
            </div>
            <div class="filters" id="filters">
                <button class="filter-btn active" onclick="filterVideos('All')">All</button>
                <!-- カテゴリボタンは_Categoriesシートから動的に生成 -->
                <button class="filter-btn add-category-filter-btn" onclick="showAddCategoryModal()" title="カテゴリを追加">
                    <svg viewBox="0 0 24 24" width="14" height="14"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="currentColor"/></svg>
                </button>
            </div>
            <div class="sort-container">
                <span class="sort-label">並び替え:</span>
                <select class="sort-select" id="sort-select" onchange="sortVideos()">
                    <option value="date-desc">追加日（新しい）</option>
                    <option value="date-asc">追加日（古い）</option>
                    <option value="title-asc">タイトル</option>
                    <option value="source">ソース別</option>
                </select>
            </div>
        </div>
    </header>

    <main>
        <section id="gallery-section">
            <div class="gallery" id="gallery">
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <p class="loading-text">動画を読み込み中...</p>
                </div>
            </div>
        </section>
    </main>

    <!-- 動画再生モーダル -->
    <div class="modal-overlay" id="modal">
        <button class="modal-close" onclick="closeModal()">
            <svg viewBox="0 0 24 24" fill="none">
                <path d="M18 6L6 18M6 6l12 12" stroke-linecap="round"/>
            </svg>
        </button>
        <div class="modal">
            <div class="modal-video" id="modal-video-container"></div>
            <div class="modal-content">
                <h2 class="modal-title" id="modal-title"></h2>
                <div class="modal-meta">
                    <div class="meta-item">
                        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                        <span id="modal-category"></span>
                    </div>
                    <div class="meta-item">
                        <svg viewBox="0 0 24 24"><path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/></svg>
                        <span id="modal-date"></span>
                    </div>
                    <div class="meta-item">
                        <svg viewBox="0 0 24 24"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"/></svg>
                        <span id="modal-source"></span>
                    </div>
                </div>
                <p class="modal-description" id="modal-description"></p>
                <div class="modal-actions" id="modal-actions">
                    <button class="modal-action-btn bookmark-btn" id="modal-bookmark-btn" onclick="toggleBookmarkFromModal()">
                        <svg viewBox="0 0 24 24"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/></svg>
                        <span>ブックマーク</span>
                    </button>
                    <button class="modal-action-btn edit-btn" onclick="openEditFromModal()">
                        <svg viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                        <span>編集</span>
                    </button>
                    <button class="modal-action-btn download-btn" onclick="downloadFromModal()">
                        <svg viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                        <span>ダウンロード</span>
                    </button>
                    <button class="modal-action-btn delete-btn" onclick="deleteFromModal()">
                        <svg viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                        <span>削除</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 編集モーダル -->
    <div class="modal-overlay" id="edit-modal">
        <div class="modal" style="max-width: 500px;">
            <button class="modal-close" onclick="closeEditModal()">
                <svg viewBox="0 0 24 24" fill="none">
                    <path d="M18 6L6 18M6 6l12 12" stroke="white" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            <div class="modal-content">
                <div style="display:flex; align-items:center; gap:1rem; margin-bottom:1.5rem;">
                    <svg viewBox="0 0 24 24" style="width:32px;height:32px;fill:#2196f3;"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                    <h2 class="modal-title" style="font-size: 1.3rem;">動画情報を編集</h2>
                </div>
                <div style="background:var(--bg-tertiary); padding:1rem; border-radius:8px; margin-bottom:1.5rem;">
                    <p style="color:var(--text-secondary); font-size:0.8rem; margin-bottom:0.3rem;">動画タイトル</p>
                    <p id="edit-video-title" style="font-weight:600;"></p>
                </div>
                <div class="form-group">
                    <label>タイトル</label>
                    <input type="text" class="form-input" id="edit-title-input" placeholder="動画のタイトル">
                </div>
                <div class="form-group">
                    <label>動画の特徴 <span style="color:var(--text-secondary); font-size:0.8rem;">(カンマ区切りで複数入力可)</span></label>
                    <textarea class="form-input" id="edit-features-input" rows="3" placeholder="例：スローモーション, ドローン撮影, アニメーション"></textarea>
                </div>
                <div class="form-group">
                    <label>カテゴリ</label>
                    <select class="form-input" id="edit-category-select"></select>
                </div>
                <div style="display:flex; gap:1rem; margin-top:1.5rem;">
                    <button class="nav-btn" onclick="closeEditModal()" style="flex:1;">キャンセル</button>
                    <button class="nav-btn primary" onclick="saveVideoEdit()" style="flex:1; background:#2196f3; border-color:#2196f3;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/>
                        </svg>
                        保存
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ブックマーク設定モーダル -->
    <div class="modal-overlay" id="bookmark-modal">
        <div class="modal" style="max-width: 400px;">
            <button class="modal-close" onclick="closeBookmarkModal()">
                <svg viewBox="0 0 24 24" fill="none">
                    <path d="M18 6L6 18M6 6l12 12" stroke="white" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            <div class="modal-content">
                <div style="text-align:center; margin-bottom:1.5rem;">
                    <svg viewBox="0 0 24 24" style="width:48px;height:48px;fill:#ffc107;"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/></svg>
                    <h2 class="modal-title" style="font-size: 1.3rem; margin-top:0.5rem;">ブックマーク設定</h2>
                </div>
                <div style="background:var(--bg-tertiary); padding:1rem; border-radius:8px; margin-bottom:1.5rem;">
                    <p style="color:var(--text-secondary); font-size:0.8rem; margin-bottom:0.3rem;">動画タイトル</p>
                    <p id="bookmark-video-title" style="font-weight:600;"></p>
                </div>
                <div class="form-group">
                    <label style="display:flex; justify-content:space-between; align-items:center;">
                        <span>保存先カテゴリ（複数選択可）</span>
                        <button class="nav-btn" onclick="showAddBookmarkCategoryModal()" style="padding:0.3rem 0.6rem; font-size:0.75rem;">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                            追加
                        </button>
                    </label>
                    <div id="bookmark-category-checkboxes" class="bookmark-checkbox-container"></div>
                </div>
                <div style="display:flex; gap:1rem; margin-top:1.5rem;">
                    <button class="nav-btn" onclick="closeBookmarkModal()" style="flex:1;">キャンセル</button>
                    <button class="nav-btn primary" onclick="saveBookmark()" style="flex:1; background:#ffc107; border-color:#ffc107; color:#000;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/>
                        </svg>
                        保存
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ブックマークカテゴリ追加モーダル -->
    <div class="modal-overlay" id="add-bookmark-category-modal">
        <div class="modal" style="max-width: 350px;">
            <button class="modal-close" onclick="closeAddBookmarkCategoryModal()">
                <svg viewBox="0 0 24 24" fill="none">
                    <path d="M18 6L6 18M6 6l12 12" stroke="white" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            <div class="modal-content">
                <h2 class="modal-title" style="font-size: 1.3rem; margin-bottom: 1.5rem;">新しいカテゴリを作成</h2>
                <div class="form-group">
                    <label>カテゴリ名</label>
                    <input type="text" class="form-input" id="new-bookmark-category-name" placeholder="例：インスピレーション">
                </div>
                <div style="display:flex; gap:1rem; margin-top:1.5rem;">
                    <button class="nav-btn" onclick="closeAddBookmarkCategoryModal()" style="flex:1;">キャンセル</button>
                    <button class="nav-btn primary" onclick="addBookmarkCategory()" style="flex:1;">作成</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ブックマークカテゴリ編集モーダル -->
    <div class="modal-overlay" id="edit-bookmark-category-modal">
        <div class="modal" style="max-width: 350px;">
            <button class="modal-close" onclick="closeEditBookmarkCategoryModal()">
                <svg viewBox="0 0 24 24" fill="none">
                    <path d="M18 6L6 18M6 6l12 12" stroke="white" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            <div class="modal-content">
                <div style="text-align:center; margin-bottom:1.5rem;">
                    <svg viewBox="0 0 24 24" style="width:48px;height:48px;fill:#ffc107;"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/></svg>
                    <h2 class="modal-title" style="font-size: 1.3rem; margin-top:0.5rem;">カテゴリを編集</h2>
                </div>
                <div class="form-group">
                    <label>カテゴリ名</label>
                    <input type="text" class="form-input" id="edit-bookmark-category-name" placeholder="カテゴリ名">
                </div>
                <div style="display:flex; gap:1rem; margin-top:1.5rem;">
                    <button class="nav-btn" onclick="closeEditBookmarkCategoryModal()" style="flex:1;">キャンセル</button>
                    <button class="nav-btn" onclick="saveBookmarkCategoryName()" style="flex:1; background:#ffc107; color:#000; border-color:#ffc107;">保存</button>
                </div>
                <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #333;">
                    <button class="nav-btn" onclick="deleteBookmarkCategory()" style="width:100%; color: #f44336; border-color: #f44336;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 0.5rem;">
                            <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                        </svg>
                        このカテゴリを削除
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ブックマーク一覧モーダル -->
    <div class="modal-overlay" id="bookmarks-modal">
        <div class="modal bookmarks-modal-inner">
            <button class="modal-close" onclick="closeBookmarksModal()">
                <svg viewBox="0 0 24 24" fill="none">
                    <path d="M18 6L6 18M6 6l12 12" stroke="white" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            <div class="modal-content">
                <div class="bookmarks-header">
                    <svg viewBox="0 0 24 24"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/></svg>
                    <h2>MY BOOKMARKS</h2>
                </div>
                <div class="bookmarks-categories" id="bookmarks-categories">
                    <button class="bookmark-cat-btn active" data-category="All">All</button>
                </div>
                <div class="bookmarks-search">
                    <svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                    <input type="text" id="bookmarks-search-input" placeholder="ブックマーク内を検索..." oninput="filterBookmarksModal()">
                </div>
                <div class="bookmarks-grid" id="bookmarks-grid"></div>
            </div>
        </div>
    </div>

    <!-- アップロードモーダル -->
    <div class="modal-overlay" id="upload-modal">
        <div class="modal" style="max-width: 600px;">
            <button class="modal-close" onclick="closeUploadModal()">
                <svg viewBox="0 0 24 24" fill="none">
                    <path d="M18 6L6 18M6 6l12 12" stroke="white" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            <div class="modal-content">
                <h2 class="modal-title" style="font-size: 1.5rem; margin-bottom: 1.5rem;">新規アップロード</h2>
                <div class="error-message" id="error-message">
                    <p id="error-text"></p>
                </div>
                <div class="upload-type-selector">
                    <div class="upload-type-btn url-type active" onclick="selectUploadType('url')">
                        <svg viewBox="0 0 24 24" style="width:32px;height:32px;fill:#ff0000;">
                            <path d="M10 15l5.19-3L10 9v6m11.56-7.83c.13.47.22 1.1.28 1.9.07.8.1 1.49.1 2.09L22 12c0 2.19-.16 3.8-.44 4.83-.25.9-.83 1.48-1.73 1.73-.47.13-1.33.22-2.65.28-1.3.07-2.49.1-3.59.1L12 19c-4.19 0-6.8-.16-7.83-.44-.9-.25-1.48-.83-1.73-1.73-.13-.47-.22-1.1-.28-1.9-.07-.8-.1-1.49-.1-2.09L2 12c0-2.19.16-3.8.44-4.83.25-.9.83-1.48 1.73-1.73.47-.13 1.33-.22 2.65-.28 1.3-.07 2.49-.1 3.59-.1L12 5c4.19 0 6.8.16 7.83.44.9.25 1.48.83 1.73 1.73z"/>
                        </svg>
                        <h3>YouTube / Vimeo</h3>
                        <p>動画URLから追加</p>
                    </div>
                    <div class="upload-type-btn dropbox-type" onclick="selectUploadType('dropbox')">
                        <svg viewBox="0 0 24 24" style="width:32px;height:32px;fill:#0061fe;">
                            <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/>
                        </svg>
                        <h3>動画ファイル</h3>
                        <p>ローカルファイルをアップロード</p>
                    </div>
                    <div class="upload-type-btn link-type" onclick="selectUploadType('link')">
                        <svg viewBox="0 0 24 24" style="width:32px;height:32px;fill:#9c27b0;">
                            <path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/>
                        </svg>
                        <h3>その他リンク</h3>
                        <p>外部サイトへのリンク</p>
                    </div>
                </div>
                <div id="upload-form">
                    <!-- URL入力（YouTube/Vimeo） -->
                    <div class="form-group" id="url-input">
                        <label>動画URL <span>*</span></label>
                        <input type="url" class="form-input" id="video-url" placeholder="YouTube / Vimeo のURLを入力" oninput="onVideoUrlChange()">
                        <div class="platform-badge" id="platform-badge" style="display:none;"></div>
                        <div class="thumbnail-preview" id="url-thumbnail-preview">
                            <img id="url-thumbnail-img" src="" alt="Thumbnail">
                        </div>
                    </div>
                    <!-- ファイルアップロード -->
                    <div class="form-group" id="file-input" style="display: none;">
                        <label>動画ファイル <span>*</span></label>
                        <div class="file-upload-area" id="drop-area">
                            <svg viewBox="0 0 24 24" style="width:40px;height:40px;fill:#0061fe;">
                                <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/>
                            </svg>
                            <h4>ドラッグ&ドロップ または クリックして選択</h4>
                            <p>MP4, MOV, AVI (最大50MB)</p>
                            <input type="file" id="video-file" accept="video/*">
                        </div>
                        <div class="selected-file" id="selected-file" style="display: none;">
                            <svg viewBox="0 0 24 24" style="width:24px;height:24px;fill:#00c853;">
                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                            </svg>
                            <div class="selected-file-info">
                                <div class="selected-file-name" id="file-name"></div>
                                <div class="selected-file-size" id="file-size"></div>
                            </div>
                            <button class="selected-file-remove" onclick="removeFile()">✕</button>
                        </div>
                    </div>
                    <!-- 外部リンク入力 -->
                    <div class="form-group" id="link-input" style="display: none;">
                        <label>リンクURL <span>*</span></label>
                        <input type="url" class="form-input" id="external-link-url" placeholder="外部サイトのURLを入力" oninput="onExternalLinkChange()">
                        <p class="input-hint">Pinterest、参考サイト、記事などのリンクを追加できます</p>
                    </div>
                    <!-- サムネイルURL入力（外部リンク用） -->
                    <div class="form-group" id="link-thumbnail-group" style="display: none;">
                        <label>サムネイル画像URL（任意）</label>
                        <input type="url" class="form-input" id="link-thumbnail-url" placeholder="https://..." oninput="onLinkThumbnailChange()">
                        <div class="thumbnail-preview" id="link-thumbnail-preview">
                            <img id="link-thumbnail-img" src="" alt="Thumbnail">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>タイトル <span>*</span></label>
                        <input type="text" class="form-input" id="video-title" placeholder="タイトルを入力">
                    </div>
                    <div class="form-group">
                        <label>特徴・メモ <span>*</span></label>
                        <textarea class="form-input" id="video-features" placeholder="特徴やメモを入力"></textarea>
                    </div>
                    <div class="form-group">
                        <label>カテゴリ <span>*</span></label>
                        <div class="category-select-wrapper">
                            <select class="form-input" id="video-category">
                                <option value="">選択してください</option>
                            </select>
                            <button type="button" class="add-category-btn" onclick="showAddCategoryModal()" title="カテゴリを追加">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="form-group" id="thumbnail-url-group" style="display: none;">
                        <label>サムネイルURL（任意）</label>
                        <input type="url" class="form-input" id="thumbnail-url" placeholder="https://...">
                        <div id="thumbnail-preview" style="display:none;margin-top:8px;">
                            <p style="font-size:12px;color:#888;margin-bottom:4px;">自動生成されたサムネイル:</p>
                        </div>
                    </div>
                    <button class="submit-btn" id="submit-btn" onclick="submitVideo()">
                        <svg viewBox="0 0 24 24" style="width:20px;height:20px;fill:currentColor;">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                        </svg>
                        アップロード
                    </button>
                    <div class="upload-progress" id="upload-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                        </div>
                        <div class="progress-text" id="progress-text">アップロード中... 0%</div>
                    </div>
                </div>
                <div class="success-message" id="success-message">
                    <svg viewBox="0 0 24 24" style="width:64px;height:64px;fill:#00c853;">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    <h3>アップロード完了！</h3>
                    <p>動画がギャラリーに追加されました</p>
                    <button class="nav-btn primary" onclick="resetUploadForm()">別の動画をアップロード</button>
                </div>
            </div>
        </div>
    </div>

    <!-- カテゴリ追加モーダル -->
    <div class="modal-overlay" id="category-modal">
        <div class="modal" style="max-width: 400px;">
            <div class="modal-content">
                <h2 class="modal-title" style="font-size: 1.5rem; margin-bottom: 1.5rem;">カテゴリを追加</h2>
                <div class="form-group">
                    <label>カテゴリ名 <span>*</span></label>
                    <input type="text" class="form-input" id="new-category-name" placeholder="新しいカテゴリ名">
                </div>
                <div class="category-modal-buttons">
                    <button class="nav-btn" onclick="closeCategoryModal()">キャンセル</button>
                    <button class="nav-btn primary" onclick="addCategory()">追加</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ゴミ箱モーダル -->
    <div class="modal-overlay" id="trash-modal">
        <div class="modal trash-modal-inner">
            <button class="modal-close" onclick="closeTrashModal()">
                <svg viewBox="0 0 24 24" fill="none">
                    <path d="M18 6L6 18M6 6l12 12" stroke="white" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            <div class="modal-content">
                <div class="trash-header">
                    <div class="trash-header-left">
                        <svg viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                        <h2>ゴミ箱</h2>
                    </div>
                    <div class="trash-actions">
                        <button onclick="restoreAllFromTrash()">
                            <svg viewBox="0 0 24 24"><path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9z"/></svg>
                            全て復元
                        </button>
                        <button class="empty-trash-btn" onclick="emptyTrash()">
                            <svg viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                            ゴミ箱を空にする
                        </button>
                    </div>
                </div>
                <div class="trash-grid" id="trash-grid"></div>
            </div>
        </div>
    </div>

    <!-- 選択ツールバー -->
    <div class="selection-toolbar" id="selection-toolbar">
        <span class="selection-count" id="selection-count">0件選択中</span>
        <button onclick="selectAllVideos()">
            <svg viewBox="0 0 24 24"><path d="M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"/></svg>
            全選択
        </button>
        <button onclick="deselectAllVideos()">
            <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
            選択解除
        </button>
        <button onclick="bookmarkSelectedVideos()">
            <svg viewBox="0 0 24 24"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/></svg>
            ブックマーク
        </button>
        <button class="delete-selected" onclick="moveSelectedToTrash()">
            <svg viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
            ゴミ箱へ
        </button>
        <button class="cancel-select" onclick="exitSelectMode()">
            キャンセル
        </button>
    </div>

    <script src="app.js"></script>
</body>
</html>
